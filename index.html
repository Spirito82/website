<!DOCTYPE html>
<html lang="it">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>B&B Luxury Bologna</title>
	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js"></script>

	<script>
		async function loadAvailability() {
			const res = await fetch('/data/availability.json', { cache: 'no-store' });
			const json = await res.json();
			return json.events || [];
		}

		function dateRangeToDates(startISO, endISO) {
			// end is exclusive in ICS; convert to days inclusive for UI
			const start = new Date(startISO);
			const end = new Date(endISO);
			const dates = [];
			for (let d = new Date(start); d < end; d.setDate(d.getDate() + 1)) {
				dates.push(new Date(d).toISOString().slice(0, 10));
			}
			return dates;
		}

		(async function initCalendar() {
			const events = await loadAvailability();

			// build day-level events for FullCalendar
			const fcEvents = [];
			events.forEach(e => {
				const days = dateRangeToDates(e.start, e.end);
				days.forEach(day => {
					fcEvents.push({
						title: e.price ? `‚Ç¨${e.price}` : '',
						start: day,
						allDay: true,
						extendedProps: { booked: true }
					});
				});
			});

			const calendarEl = document.getElementById('calendar');
			const calendar = new FullCalendar.Calendar(calendarEl, {
				initialView: 'dayGridMonth',
				selectable: true,
				events: fcEvents,
				dayCellDidMount: function (info) {
					// se il giorno √® segnato come booked da events, FullCalendar lo ha reso nel DOM?
					// use eventsByDate lookup instead for performance
				},
				eventDidMount: function (info) {
					// aggiungi classe visiva per i giorni occupati
					info.el.classList.add('fc-booked-day');
					// qui puoi aggiungere un overlay (croce) via pseudo-elementi CSS
				},
				select: function (selectionInfo) {
					// quando l'utente seleziona range => abilita il bottone mail
					const start = selectionInfo.startStr;
					const end = selectionInfo.endStr; // end exclusive
					document.getElementById('bookEmailBtn').disabled = false;
					document.getElementById('bookEmailBtn').dataset.start = start;
					document.getElementById('bookEmailBtn').dataset.end = end;
				}
			});

			// render calendar
			calendar.render();

			// stile per giorni prenotati
			const style = document.createElement('style');
			style.innerHTML = `
      .fc-booked-day { background: repeating-linear-gradient(45deg, rgba(0,0,0,0.06), rgba(0,0,0,0.06) 6px, rgba(255,0,0,0.04) 6px, rgba(255,0,0,0.04) 12px); }
      /* puoi mettere croce via pseudo-elementi se vuoi */
    `;
			document.head.appendChild(style);

			// button mailto
			document.getElementById('bookEmailBtn').addEventListener('click', function () {
				const start = this.dataset.start;
				const end = this.dataset.end;
				const subject = encodeURIComponent(`Richiesta prenotazione - B&B Luxury Bologna - ${start} ‚Üí ${end}`);
				const body = encodeURIComponent(
					`Buongiorno,\n\nVorrei prenotare il B&B Luxury Bologna dal ${start} al ${end}.\nNumero di ospiti: \nNome:\nTelefono:\n\nGrazie,\n`
				);
				// open mail client
				window.location.href = `mailto:info@bbluxurybologna.it?subject=${subject}&body=${body}`;
			});
		})();
	</script>
</head>

<body>

	<!-- Navbar -->
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
		<div class="container">
			<a class="navbar-brand" href="#home">B&B Luxury Bologna</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav ms-auto">
					<li class="nav-item"><a class="nav-link" href="#home">Home</a></li>
					<li class="nav-item"><a class="nav-link" href="#gallery">Foto</a></li>
					<li class="nav-item"><a class="nav-link" href="#availability">Disponibilit√†</a></li>
					<li class="nav-item"><a class="nav-link" href="#rules">Regole</a></li>
					<li class="nav-item"><a class="nav-link" href="#services">Servizi</a></li>
					<li class="nav-item"><a class="nav-link" href="#reviews">Recensioni</a></li>
					<li class="nav-item"><a class="nav-link" href="#explore">Scopri Bologna</a></li>
					<li class="nav-item"><a class="nav-link" href="#faq">FAQ</a></li>
					<li class="nav-item"><a class="nav-link" href="#contacts">Contatti</a></li>
				</ul>
			</div>
		</div>
	</nav>

	<!-- Hero / Home -->
	<section id="home" class="vh-100 d-flex align-items-center text-center bg-light">
		<div class="container">
			<h1 class="display-4 fw-bold">B&B Luxury Bologna</h1>
			<p class="lead">Il tuo rifugio elegante nel cuore di Bologna</p>
			<a href="#availability" class="btn btn-primary btn-lg mt-3">Prenota ora</a>
		</div>
	</section>

	<!-- Foto / Gallery -->
	<section id="gallery" class="py-5 bg-white">
		<div class="container">
			<h2 class="mb-4 text-center">Foto</h2>
			<div class="row g-3" id="gallery-container"></div>
		</div>
	</section>

	<script>
		// elenco immagini nella cartella /images
		const images = [
			"images/1.jpg",
			"images/2.jpg",
			"images/3.jpg",
			"images/4.jpg"
		];

		// ordino alfabeticamente
		images.sort();

		const container = document.getElementById("gallery-container");

		images.forEach(src => {
			const col = document.createElement("div");
			col.className = "col-md-4";
			col.innerHTML = `<img src="${src}" class="img-fluid rounded" alt="Foto">`;
			container.appendChild(col);
		});
	</script>

	<!-- Disponibilit√† -->
	<section id="availability" class="py-5 bg-light">
		<div class="container">
			<h2 class="mb-4 text-center">Disponibilit√† & Prezzi</h2>
			<div id="calendar"></div>
			<button id="bookEmailBtn" class="btn btn-primary mt-3" disabled>Prenota</button>
			<div class="text-center">
				<a href="#" class="btn btn-success">Prenota su Booking</a>
			</div>
		</div>
	</section>

	<!-- Regole -->
	<section id="rules" class="py-5 bg-white">
		<div class="container">
			<h2 class="mb-4 text-center">Regole del B&B</h2>
			<ul>
				<li>Check-in: dalle 14:00 alle 20:00</li>
				<li>Check-out: entro le 11:00</li>
				<li>Non fumare all‚Äôinterno</li>
				<li>No animali domestici</li>
			</ul>
		</div>
	</section>

	<!-- Servizi -->
	<section id="services" class="py-5 bg-light">
		<div class="container">
			<h2 class="mb-4 text-center">Servizi</h2>
			<div class="row text-center">
				<div class="col-md-4">
					<p>üç≥ Colazione pronta</p>
				</div>
				<div class="col-md-4">
					<p>‚òï Macchina del caff√®</p>
				</div>
				<div class="col-md-4">
					<p>üì∂ Wi-Fi veloce</p>
				</div>
			</div>
		</div>
	</section>

	<!-- Recensioni -->
	<section id="reviews" class="py-5 bg-white">
		<div class="container">
			<h2 class="mb-4 text-center">Recensioni</h2>
			<blockquote class="blockquote text-center">
				<p class="mb-0">‚ÄúPulizia impeccabile e posizione perfetta‚Äù</p>
				<footer class="blockquote-footer">Valutazione: 9.5/10 su Booking</footer>
			</blockquote>
		</div>
	</section>

	<!-- Scopri Bologna -->
	<section id="explore" class="py-5 bg-light">
		<div class="container">
			<h2 class="mb-4 text-center">Scopri Bologna</h2>
			<p class="text-center">A pochi passi da Piazza Maggiore, le Due Torri e il Mercato delle Erbe.</p>
		</div>
	</section>

	<!-- FAQ -->
	<section id="faq" class="py-5 bg-white">
		<div class="container">
			<h2 class="mb-4 text-center">FAQ</h2>
			<p><strong>Dove parcheggiare?</strong> Ci sono parcheggi a pagamento a 300m dal B&B.</p>
			<p><strong>Colazione inclusa?</strong> S√¨, troverai la colazione pronta in appartamento.</p>
		</div>
	</section>

	<!-- Contatti -->
	<section id="contacts" class="py-5 bg-light">
		<div class="container text-center">
			<h2 class="mb-4">Contatti</h2>
			<p>Email: info@bbluxurybologna.it</p>
			<p>Tel: +39 333 123 4567</p>
			<div class="ratio ratio-16x9 mt-4">
				<iframe src="https://www.google.com/maps/embed?pb=!1m18!..." allowfullscreen></iframe>
			</div>
		</div>
	</section>

	<!-- Footer -->
	<footer class="bg-dark text-light text-center py-3">
		<p class="mb-0">&copy; 2025 B&B Luxury Bologna - Tutti i diritti riservati</p>
	</footer>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>